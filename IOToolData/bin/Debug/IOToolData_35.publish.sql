/*
Deployment script for IOToolData

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "IOToolData"
:setvar DefaultFilePrefix "IOToolData"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Creating Procedure [dbo].[spPrices_GetByIdToEdit]...';


GO
CREATE PROCEDURE [dbo].[spPrices_GetByIdToEdit]
	@Id int
AS
begin

	set nocount on;

	select [Prices].[Id] as Id, [Transporters].[Name] as TransporterName, [Prices].[LaneName] as LaneName,
		   [OriginCountry].[Name] as OriginCountry, [OriginCity].[Name] as OriginCity,
		   [DestinationCountry].[Name] as DestinationCountry, [DestinationCity].[Name] as DestinationCity,
		   [RequestType].[Type] as RequestType, [Prices].[Minimum] as Minimum, [Prices].[From1To4Pallets] as From1To4Pallets,
		   [Prices].[From5To8Pallets] as From5To8Pallets, [Prices].[From9To12Pallets] as From9To12Pallets,
		   [Prices].[From13To16Pallets] as From13To16Pallets, [Prices].[From17To20Pallets] as From17To20Pallets,
		   [Prices].[From21To24Pallets] as From21To24Pallets, [Prices].[From25To28Pallets] as From25To28Pallets,
		   [Prices].[From29To32Pallets] as From29To32Pallets, [Prices].[From33To36Pallets] as From33To36Pallets,
		   [Prices].[From37To40Pallets] as From37To40Pallets, [Prices].[From41To44Pallets] as From41To44Pallets,
		   [Prices].[From45To48Pallets] as From45To48Pallets, [Prices].[From49To52Pallets] as From49To52Pallets,
		   [Prices].[From53To56Pallets] as From53To56Pallets, [Prices].[From57To60Pallets] as From57To60Pallets,
		   [Prices].[From61To64Pallets] as From61To64Pallets, [Prices].[Maximum] as Maximum,
		   [Prices].[ShipmentFrequencyLTL] as ShipmentFrequencyLTL, [Prices].[TransitTimeGroupage] as TransitTimeGroupage,
		   [Prices].[TransitTimeLTL] as TransitTimeLTL, [Prices].[CommentsLTL] as CommentsLTL,
		   [Prices].[Tons3_5] as Tons3_5, [Prices].[TransitTime3_5Tons] as TransitTime3_5Tons,
		   [Prices].[ShipmentFrequency3_5Tons] as ShipmentFrequency3_5Tons, [Prices].[Tons7_5] as Tons7_5,
		   [Prices].[ShipmentFrequency7_5Tons] as ShipmentFrequency7_5Tons, [Prices].[Tons24] as Tons24,
		   [Prices].[ShipmentFrequency24Tons] as ShipmentFrequency24Tons, [Prices].[TransitTimeFTL] as TransitTimeFTL,
		   [Prices].[CommentsFTL] as CommentsFTL
	from dbo.[Prices]
	join dbo.[Transporters] on [Prices].[Id_Transporter] = [Transporters].[Id]
	join dbo.[Countries] as OriginCountry on [Prices].[Id_OriginCountry] = [OriginCountry].[Id]
	join dbo.[Cities] as OriginCity on [Prices].[Id_OriginCity] = [OriginCity].[Id]
	join dbo.[Countries] as DestinationCountry on [Prices].[Id_DestinationCountry] = [DestinationCountry].[Id]
	join dbo.[Cities] as DestinationCity on [Prices].[Id_DestinationCity] = [DestinationCity].[Id]
	join dbo.[RequestTypes] as RequestType on [Prices].[Id_RequestType] = [RequestType].[Id]
	where [Prices].[Id] = @Id

end
GO
/*
Post-Deployment Script Template							
--------------------------------------------------------------------------------------
 This file contains SQL statements that will be appended to the build script.		
 Use SQLCMD syntax to include a file in the post-deployment script.			
 Example:      :r .\myfile.sql								
 Use SQLCMD syntax to reference a variable in the post-deployment script.		
 Example:      :setvar TableName MyTable							
               SELECT * FROM [$(TableName)]					
--------------------------------------------------------------------------------------
*/



if not exists (select * from dbo.AdGroups)
begin
    insert into dbo.AdGroups([Name], [Location], [FullDomain], [ShortDomain], [RightsName], [Active])
    values ('bra1_2515_IOTool_Level1', 'vt1.vitesco.com/lda/ro/bra1/Administration/DSOfficeGroups/bra1_2515_IOTool_Level1', 'vt1.vitesco.com', 'vt1', 'Level1', 1),
           ('bra1_2515_IOTool_Level2', 'vt1.vitesco.com/lda/ro/bra1/Administration/DSOfficeGroups/bra1_2515_IOTool_Level2', 'vt1.vitesco.com', 'vt1', 'Level2', 1),
           ('bra1_2515_IOTool_Level3', 'vt1.vitesco.com/lda/ro/bra1/Administration/DSOfficeGroups/bra1_2515_IOTool_Level3', 'vt1.vitesco.com', 'vt1', 'Level3', 1),
           ('bra1_2515_IOTool_Level4', 'vt1.vitesco.com/lda/ro/bra1/Administration/DSOfficeGroups/bra1_2515_IOTool_Level4', 'vt1.vitesco.com', 'vt1', 'Level4', 1),
           ('bra1_2515_IOTool_Level5', 'vt1.vitesco.com/lda/ro/bra1/Administration/DSOfficeGroups/bra1_2515_IOTool_Level5', 'vt1.vitesco.com', 'vt1', 'Level5', 1)
end

if not exists (select * from dbo.Materials)
begin
    insert into dbo.Materials([Material], [Active])
    values('Materials', 1),
          ('Packaging', 1)
end

if not exists (select * from dbo.RequestStatus)
begin
    insert into dbo.RequestStatus([Status], [Active])
    values ('Open', 1),
           ('InProgress', 1),
           ('Resolved', 1),
           ('Closed', 1),
           ('Deleted', 1)
end

if not exists (select * from dbo.RequestTypes)
begin
    insert into dbo.RequestTypes([Type], [Active])
    values ('Inbound', 1),
           ('Outbound', 1)
end

if not exists (select * from dbo.Smtp)
begin
    insert into dbo.Smtp([Server], [Port], [EmailSender], [Active])
    values ('smtp.vitesco-technologies.net', 25, 'IOTool <VT_GX_SM_System_Notification_Service@vitesco-technologies.net>', 1)
end

if not exists (select * from dbo.TransportTypes)
begin
    insert into dbo.TransportTypes([Type], [Active] )
    values ('Land', 1),
           ('Parcel', 1),
           ('Sea', 1),
           ('Air', 1)
end
GO

GO
PRINT N'Update complete.';


GO
